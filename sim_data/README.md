After generating the MAT file in [sim_info](https://github.com/rehmanali1994/FrequencyDifferencing/tree/main/Simulations/sim_info), we run the actual [k-Wave](http://www.k-wave.org/) simulation using [kWaveSimLauncher.m](https://github.com/rehmanali1994/3D-FWI-MultiRowRingArrayUST/blob/main/kWaveSimLauncher.m), which loops through each single-element transmit (function calls to [GenRFDataSingleTxKWave.m](https://github.com/rehmanali1994/FrequencyDifferencing/blob/main/Simulations/GenRFDataSingleTxKWave.m)). The simulated data for each transmit is then stored in MAT files in this folder (the [sim_data](https://github.com/rehmanali1994/3D-FWI-MultiRowRingArrayUST/tree/main/sim_data) folder).  To conserve space, the traces simulated for each transmit are Fourier transformed, and the scripts in the [visualization](https://github.com/rehmanali1994/3D-FWI-MultiRowRingArrayUST/tree/main/visualization) folder can be used to visualize the time-domain data for each transmit.  At the end of [kWaveSimLauncher.m](https://github.com/rehmanali1994/3D-FWI-MultiRowRingArrayUST/blob/main/kWaveSimLauncher.m), the function call to 
[AssembleSimData.m](https://github.com/rehmanali1994/3D-FWI-MultiRowRingArrayUST/blob/main/AssembleSimData.m) assembles the simulated data from each indivdual transmit/MAT-file in the [sim_data](https://github.com/rehmanali1994/3D-FWI-MultiRowRingArrayUST/tree/main/sim_data) folder into a single MAT file (either _LeftBreastMRI.mat_ or _RightBreastMRI.mat_) containing the 3D UST dataset needed for FWI (stored in the [datasets](https://github.com/rehmanali1994/3D-FWI-MultiRowRingArrayUST/tree/main/datasets) folder).  Note that the complete time-series data is too large to store in a single file for the full 3D dataset.  Instead, we extract only the frequencies listed in [kWaveSimLauncher.m](https://github.com/rehmanali1994/3D-FWI-MultiRowRingArrayUST/blob/main/kWaveSimLauncher.m) to keep the file size for the full 3D dataset small. 
